import 'package:brain_pulse/core/Theming/text_style.dart';
import 'package:brain_pulse/core/helpers/extentions.dart';
import 'package:brain_pulse/core/helpers/shared_pref_helper/shared_pref_helper.dart';
import 'package:brain_pulse/features/home/presentation/screens/widgets/custom_button.dart';
import 'package:brain_pulse/features/more/ui/screen/my_profile.dart';
import 'package:brain_pulse/features/more/ui/screen/show_my_profile.dart';
import 'package:flutter/material.dart';
import 'package:flutter_screenutil/flutter_screenutil.dart';
import 'package:path/path.dart';
import '../../core/Theming/colors.dart';
import '../../core/helpers/spacing.dart';

class More extends StatelessWidget {
  const More({super.key});
  static const String routeName = 'More';

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: ColorsApp.white,
      body: Padding(
        padding: const EdgeInsets.only(top: 110, right: 10, left: 10),
        child: SingleChildScrollView(
          child: Column(
            children: [
              const MyProfile(),
              gapH(10.h),
              buildSection(
                title: "Personal Information",
                items: [
                  buildListItem(context, Icons.person, "My profile", "....."),
                ],
              ),
              buildSection(
                title: "Settings",
                items: [
                  buildListItem(context, Icons.language, "Language",
                      "Account language settings"),
                  buildListItem(context, Icons.mode_night_outlined, "Mode",
                      "Account Mode settings"),
                ],
              ),
              buildSection(
                title: "About Us",
                items: [
                  buildListItem(
                      context, Icons.mood_rounded, "About Us", "....."),
                ],
              ),
              buildSection(
                title: "Logout",
                items: [
                  buildListItem(context, Icons.logout, "logout", "....."),
                ],
              ),
            ],
          ),
        ),
      ),
    );
  }

  Widget buildSection({required String title, required List<Widget> items}) {
    return Padding(
      padding: EdgeInsets.all(16.w),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Text(title, style: TextStyleApp.font18boldBlack),
          gapH(10.h),
          ...items,
        ],
      ),
    );
  }

  Widget buildListItem(
      BuildContext context, IconData icon, String title, String subtitle) {
    return Card(
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(15.r),
      ),
      child: ListTile(
        leading: Icon(icon, color: ColorsApp.blue),
        title: Text(
          title,
          style: TextStyleApp.font18boldBlack,
        ),
        subtitle: Text(subtitle),
        trailing: Icon(Icons.arrow_forward_ios, color: ColorsApp.grey),
        onTap: () {
          if (title == "My profile") {
            Navigator.push(
              context,
              MaterialPageRoute(builder: (context) => const ShowMyProfile()),
            );
          } else if (title == "Language") {
            showBottomSheetOptions(context, "اختر اللغة", ["عربي", "English"]);
          } else if (title == "Mode") {
            showBottomSheetOptions(context, "اختر الوضع", ["نهاري", "ليلي"]);
          } else if (title == "About Us") {
            showBottomSheetOptions(
                context,
                "Electroencephalography (EEG) is a medical technique used to monitor and record electrical activity in the brain, helping doctors diagnose a variety of neurological disorders. Electrodes are placed on the scalp to pick up electrical signals generated by the activity of neurons. EEG is commonly used to diagnose epilepsy, sleep disorders, and changes in consciousness. Additionally, it can help evaluate conditions such as encephalitis, tumors, and brain injuries, making it a valuable tool in neurology",
                []);
          } else if (title == 'logout') {
            showModalBottomSheet(
              context: context,
              builder: (context) {
                return Container(
                  height: 400.h,
                  decoration: BoxDecoration(
                    borderRadius: BorderRadius.only(
                      topLeft: Radius.circular(16.r),
                      topRight: Radius.circular(16.r),
                    ),
                    color: Colors.white,
                  ),
                  child: Padding(
                    padding: EdgeInsets.symmetric(horizontal: 16.w),
                    child: Column(
                      children: [
                        gapH(10),
                        Row(
                          children: [
                            IconButton(
                              onPressed: () {
                                context.pop();
                              },
                              icon: const Icon(
                                Icons.close,
                                color: Colors.grey,
                              ),
                            )
                          ],
                        ),
                        gapH(20),
                        Container(
                          width: 150.w,
                          height: 150.h,
                          decoration: BoxDecoration(
                            color: ColorsApp.darkRed,
                            shape: BoxShape.circle,
                          ),
                          child: Center(
                            child: Icon(
                              Icons.logout,
                              color: Colors.white,
                              weight: 45.w,
                              size: 40,
                            ),
                          ),
                        ),
                        gapH(10),
                        Text(
                          'logout now !',
                          style: TextStyle(
                            fontSize: 24.sp,
                            fontWeight: FontWeight.bold,
                            color: Colors.black,
                          ),
                        ),
                        gapH(20),
                        Row(
                          mainAxisAlignment: MainAxisAlignment.spaceBetween,
                          children: [
                            CustomButton(
                              onTap: () {
                                SharedPrefHelper.clearAllData();
                                context.pushReplacementNamed('/loginScreen');
                              },
                              text: 'logout',
                              width: 230,
                              height: 50,
                              color: Colors.white,
                              textColor: ColorsApp.darkRed,
                              borderColor: ColorsApp.darkRed,
                            ),
                            CustomButton(
                              onTap: () {
                                context.pop();
                              },
                              text: 'cancel',
                              width: 100,
                              height: 50,
                              color: Colors.white,
                              textColor: ColorsApp.grey,
                              borderColor: ColorsApp.grey,
                            )
                          ],
                        )
                      ],
                    ),
                  ),
                );
              },
            );
          }
        },
      ),
    );
  }
}

void showBottomSheetOptions(
    BuildContext context, String title, List<String> options) {
  showModalBottomSheet(
    context: context,
    shape: RoundedRectangleBorder(
      borderRadius: BorderRadius.vertical(top: Radius.circular(20.r)),
    ),
    builder: (BuildContext context) {
      return Container(
        padding: EdgeInsets.all(20.w),
        child: Column(
          mainAxisSize: MainAxisSize.min,
          children: [
            Text(
              title,
              style: TextStyleApp.font18boldBlack,
            ),
            SizedBox(height: 20.h),
            ...options.map((option) => ListTile(
                  title: Text(option),
                  onTap: () {
                    Navigator.pop(context);
                  },
                )),
          ],
        ),
      );
    },
  );
}
